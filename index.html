<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battleship Game</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcome-screen" class="screen active">
        <h1>BATTLESHIP</h1>
        <button id="settings-btn" class="main-btn secondary">Settings</button>
        <button id="start-game-btn" class="main-btn">Start Game</button>
        <button id="online-play-btn" class="main-btn" style="background-color: #20a39e;">Online Play</button>
    </div>

    <!-- Online Menu Screen -->
    <div id="online-menu-screen" class="screen">
        <h2>Online Play</h2>
        <div style="max-width: 400px; margin: 0 auto; text-align: center;">
            <button id="create-room-btn" class="main-btn" style="margin-bottom: 20px;">Create Room</button>
            <p>OR</p>
            <div style="margin: 20px 0;">
                <input type="text" id="room-code-input" placeholder="Enter room code to join" 
                       style="padding: 10px; width: 100%; box-sizing: border-box; margin-bottom: 10px;">
                <button id="join-room-btn" class="main-btn secondary">Join Room</button>
            </div>
            <button id="back-from-online-btn" class="main-btn secondary" style="margin-top: 20px;">Back</button>
        </div>
    </div>

    <!-- Room Code Display Screen -->
    <div id="room-code-screen" class="screen">
        <h2>Room Code</h2>
        <div style="max-width: 400px; margin: 0 auto; text-align: center;">
            <p>Share this code with your opponent:</p>
            <div id="room-code-display" style="background: #1a1a1a; padding: 20px; border-radius: 10px; margin: 20px 0; border: 2px solid #20a39e;">
                <div id="room-code-text" style="font-size: 32px; font-weight: bold; color: #20a39e; letter-spacing: 5px; margin-bottom: 10px;">XXXX</div>
                <button id="copy-code-btn" class="main-btn" style="width: 100%;">Copy Code</button>
            </div>
            <p>Waiting for opponent to join...</p>
            <div id="opponent-status" style="margin-top: 20px; color: #888;">Opponent: Not joined</div>
            <button id="back-to-online-btn" class="main-btn secondary" style="margin-top: 20px;">Back</button>
        </div>
    </div>
    
    <!-- Ready Up Screen -->
    <div id="ready-up-screen" class="screen">
        <h2>Game Settings</h2>
        <div style="max-width: 500px; margin: 0 auto;">
            <div style="background: rgba(32, 163, 158, 0.2); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                <p><strong>Grid Size:</strong> <span id="ready-grid-size">10x10</span></p>
                <p><strong>Shooting Rule:</strong> <span id="ready-shooting-rule">One Shot</span></p>
                <p><strong>Fog of War:</strong> <span id="ready-fog-of-war">Off</span></p>
                <p><strong>Power-Ups:</strong> <span id="ready-power-ups">Off</span></p>
            </div>
            
            <div style="background: rgba(32, 163, 158, 0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                <p><strong>You:</strong> <span id="you-ready-status" style="color: #f44336;">Not Ready</span></p>
                <p><strong>Opponent:</strong> <span id="opponent-ready-status" style="color: #f44336;">Not Ready</span></p>
            </div>
            
            <button id="ready-confirm-btn" class="main-btn" style="width: 100%; margin-bottom: 10px;">I'm Ready</button>
            <button id="back-to-online-from-ready-btn" class="main-btn secondary" style="width: 100%;">Back</button>
        </div>
    </div>
    
    <!-- Waiting for Placement Screen -->
    <div id="waiting-for-placement-screen" class="screen">
        <h2>Waiting for Opponent</h2>
        <div style="max-width: 400px; margin: 0 auto; text-align: center;">
            <p style="font-size: 18px; margin: 30px 0;">You've finished placing your ships!</p>
            <p style="color: #888;">Waiting for your opponent to finish placing their ships...</p>
            <div style="margin: 40px 0;">
                <div class="loading-spinner" style="width: 50px; height: 50px; border: 4px solid #20a39e; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
            </div>
        </div>
    </div>
    
    <!-- Waiting for Turn Screen -->
    <div id="waiting-for-turn-screen" class="screen">
        <h2>Waiting for Opponent's Turn</h2>
        <div style="max-width: 400px; margin: 0 auto; text-align: center;">
            <p style="font-size: 18px; margin: 30px 0;">Your opponent is taking their turn...</p>
            <div style="margin: 40px 0;">
                <div class="loading-spinner" style="width: 50px; height: 50px; border: 4px solid #20a39e; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
            </div>
        </div>
    </div>

    <!-- Settings Screen -->
    <div id="settings-screen" class="screen">
        <h2>Game Settings</h2>
        
        <!-- Room Code Display for Online Mode -->
        <div id="online-room-code-display" style="display: none; background: rgba(32, 163, 158, 0.2); padding: 15px; margin-bottom: 20px; border-radius: 10px; text-align: center; max-width: 400px; margin-left: auto; margin-right: auto;">
            <p style="margin: 0 0 10px 0; color: #888;">Room Code:</p>
            <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; margin-bottom: 10px; border: 2px solid #20a39e;">
                <div id="settings-room-code-text" style="font-size: 28px; font-weight: bold; color: #20a39e; letter-spacing: 3px;">XXXX</div>
            </div>
            <button id="copy-settings-code-btn" class="main-btn" style="width: 100%;">Copy Code</button>
        </div>
        
        <div class="settings-wrapper">
            <div class="settings-left">
                <div class="settings-container">
                    <div class="setting-group">
                        <h3>Grid Size</h3>
                        <div class="option-group">
                            <label>
                                <input type="radio" name="gridSize" value="7" data-max-ships="7">
                                <span>7x7 (Max 7 ships)</span>
                            </label>
                            <label>
                                <input type="radio" name="gridSize" value="10" checked data-max-ships="10">
                                <span>10x10 (Max 10 ships)</span>
                            </label>
                            <label>
                                <input type="radio" name="gridSize" value="12" data-max-ships="12">
                                <span>12x12 (Max 12 ships)</span>
                            </label>
                            <label>
                                <input type="radio" name="gridSize" value="15" data-max-ships="15">
                                <span>15x15 (Max 15 ships)</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="settings-container">
                    <div class="setting-group">
                        <h3>Fog of War</h3>
                        <div class="option-group">
                            <label>
                                <input type="radio" name="fogOfWar" value="off" checked>
                                <span>Off - See hit/miss feedback</span>
                            </label>
                            <label>
                                <input type="radio" name="fogOfWar" value="on">
                                <span>On - Only see sunk ships</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="settings-container">
                    <div class="setting-group">
                        <h3>Game Mode</h3>
                        <div class="option-group">
                            <label>
                                <input type="radio" name="gameMode" value="pvp" checked>
                                <span>PvP - Fight Another Player</span>
                            </label>
                            <label>
                                <input type="radio" name="gameMode" value="ai">
                                <span>AI - Fight Computer (Beta)</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="settings-container" id="ai-difficulty-container" style="display: none;">
                    <div class="setting-group">
                        <h3>AI Difficulty</h3>
                        <div class="option-group">
                            <label>
                                <input type="radio" name="aiDifficulty" value="easy" checked>
                                <span>Easy - Predictable patterns</span>
                            </label>
                            <label>
                                <input type="radio" name="aiDifficulty" value="medium">
                                <span>Medium - Basic checkerboard</span>
                            </label>
                            <label>
                                <input type="radio" name="aiDifficulty" value="hard">
                                <span>Hard - Optimal search</span>
                            </label>
                            <label>
                                <input type="radio" name="aiDifficulty" value="impossible">
                                <span>Impossible - Always hits</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="settings-container">
                    <div class="setting-group">
                        <h3>Power-Ups</h3>
                        <div class="option-group">
                            <label>
                                <input type="radio" name="powerUps" value="off" checked>
                                <span>Off - No power-ups</span>
                            </label>
                            <label>
                                <input type="radio" name="powerUps" value="on">
                                <span>On - Enable power-ups</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="settings-right">
                <div class="settings-container">
                    <div class="setting-group">
                        <h3>Shooting Rules</h3>
                        <div class="option-group">
                            <label>
                                <input type="radio" name="shootingRules" value="oneshot" checked>
                                <span>One shot per person</span>
                            </label>
                            <label>
                                <input type="radio" name="shootingRules" value="twoshots">
                                <span>Two shots per person</span>
                            </label>
                            <label>
                                <input type="radio" name="shootingRules" value="threeshots">
                                <span>Three shots per person</span>
                            </label>
                            <label>
                                <input type="radio" name="shootingRules" value="tillmiss">
                                <span>Shoot till you miss</span>
                            </label>
                            <label>
                                <input type="radio" name="shootingRules" value="shipfire">
                                <span>Ship Fire (shots = number of ships)</span>
                            </label>
                        </div>
                        <p id="rule-description" class="rule-description">Get one shot per turn</p>
                    </div>
                </div>

                <div class="settings-container">
                    <div class="setting-group">
                        <h3>Ships Configuration</h3>
                        <div class="ships-config-group">
                            <div class="ship-config-item">
                                <label>Carrier (5 cells)</label>
                                <input type="number" class="ship-count" data-ship="Carrier" min="0" max="10" value="1">
                            </div>
                            <div class="ship-config-item">
                                <label>Battleship (4 cells)</label>
                                <input type="number" class="ship-count" data-ship="Battleship" min="0" max="10" value="1">
                            </div>
                            <div class="ship-config-item">
                                <label>Cruiser (3 cells)</label>
                                <input type="number" class="ship-count" data-ship="Cruiser" min="0" max="10" value="1">
                            </div>
                            <div class="ship-config-item">
                                <label>Submarine (3 cells)</label>
                                <input type="number" class="ship-count" data-ship="Submarine" min="0" max="10" value="1">
                            </div>
                            <div class="ship-config-item">
                                <label>Destroyer (2 cells)</label>
                                <input type="number" class="ship-count" data-ship="Destroyer" min="0" max="10" value="1">
                            </div>
                        </div>
                        <p id="ship-count-display" class="ship-count-display">Total Ships: 5/10</p>
                        <p id="ship-error-message" class="ship-error-message" style="display: none;">Invalid Settings - Please fix them</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="settings-buttons">
            <button id="back-to-welcome-btn" class="main-btn">Back</button>
            <button id="ready-settings-btn" class="main-btn" style="display: none;">Ready Up</button>
        </div>
    </div>

    <!-- Player Turn Screen (Blank with Play Button) -->
    <div id="player-turn-screen" class="screen">
        <h1 id="player-turn-text">Player 1 - Your Turn!</h1>
        <button id="play-btn" class="main-btn">Play</button>
    </div>

    <!-- Ship Placement Screen -->
    <div id="placement-screen" class="screen">
        <h2 id="placement-title">Player 1 - Place Your Ships</h2>
        <div class="game-info">
            <p id="current-ship-info">Place your Carrier (5 cells)</p>
            <button id="rotate-btn" class="control-btn">Rotate Ship</button>
        </div>
        <div class="board-container">
            <div class="legend">
                <h4>Legend:</h4>
                <div class="legend-item">
                    <div class="legend-square water"></div>
                    <span>Water</span>
                </div>
                <div class="legend-item">
                    <div class="legend-square ship"></div>
                    <span>Your Ship</span>
                </div>
                <div class="legend-item">
                    <div class="legend-square preview"></div>
                    <span>Valid Placement</span>
                </div>
                <div class="legend-item">
                    <div class="legend-square invalid"></div>
                    <span>Invalid Placement</span>
                </div>
            </div>
            <div id="placement-board" class="board"></div>
            <div class="ship-selector">
                <h4>Select Ship:</h4>
                <div id="ship-list">
                    <!-- Ships will be added here dynamically -->
                </div>
            </div>
        </div>
        <button id="done-placement-btn" class="main-btn" disabled>Done</button>
    </div>

    <!-- Battle Screen -->
    <div id="battle-screen" class="screen">
        <h2 id="battle-title">Player 1 - Attack!</h2>
        <div class="battle-container">
            <div class="legend">
                <h4>Legend:</h4>
                <div id="legend-normal" style="display: none;">
                    <div class="legend-item">
                        <div class="legend-square water"></div>
                        <span>Water</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-square ship"></div>
                        <span>Your Ship</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-square hit"></div>
                        <span>Hit</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-square miss"></div>
                        <span>Miss</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-square sunk"></div>
                        <span>Sunk Ship</span>
                    </div>
                </div>
                <div id="legend-fog-of-war" style="display: none;">
                    <div class="legend-item">
                        <div class="legend-square water"></div>
                        <span>Water (Not shot)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-square ship"></div>
                        <span>Your Ship</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-square shot-marker"></div>
                        <span>Shot (Hit or Miss)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-square sunk"></div>
                        <span>Sunk Ship</span>
                    </div>
                </div>
            </div>
            <div class="board-wrapper">
                <h3>Your Board</h3>
                <div id="own-board" class="board"></div>
            </div>
            <div class="board-wrapper">
                <h3>Enemy Waters</h3>
                <div id="enemy-board" class="board"></div>
            </div>
        </div>
        <div id="power-ups-container" class="power-ups-container" style="display: none;">
            <h3>Power-Ups <span id="power-points" class="power-points">Power Points: 2</span></h3>
            <div class="power-ups-buttons">
                <button id="sonar-btn" class="power-up-btn" disabled>
                    <span class="power-up-name">Sonar Pulse</span>
                    <span class="power-up-cost">Cost: 1</span>
                    <span class="power-up-desc">Reveal 3x3 area</span>
                </button>
                <button id="extra-shot-btn" class="power-up-btn" disabled>
                    <span class="power-up-name">Extra Shot</span>
                    <span class="power-up-cost">Cost: 1</span>
                    <span class="power-up-desc">+1 shot this turn</span>
                </button>
                <button id="cloak-btn" class="power-up-btn" disabled>
                    <span class="power-up-name">Cloak</span>
                    <span class="power-up-cost">Cost: 1</span>
                    <span class="power-up-desc">Hide your feedback</span>
                </button>
                <button id="scope-btn" class="power-up-btn" disabled style="display: none;">
                    <span class="power-up-name">Scope</span>
                    <span class="power-up-cost">Cost: 1</span>
                    <span class="power-up-desc">See hit/miss feedback</span>
                </button>
            </div>
        </div>
        <button id="end-turn-btn" class="main-btn" disabled>End Turn</button>
    </div>

    <!-- Game Over Screen -->
    <div id="game-over-screen" class="screen">
        <h1 id="winner-text">Player 1 Wins!</h1>
        <div class="stats">
            <h2>Game Statistics</h2>
            <div class="player-stats">
                <h3>Player 1</h3>
                <p>Shots Fired: <span id="p1-shots">0</span></p>
                <p>Hits: <span id="p1-hits">0</span></p>
                <p>Accuracy: <span id="p1-accuracy">0</span>%</p>
            </div>
            <div class="player-stats">
                <h3>Player 2</h3>
                <p>Shots Fired: <span id="p2-shots">0</span></p>
                <p>Hits: <span id="p2-hits">0</span></p>
                <p>Accuracy: <span id="p2-accuracy">0</span>%</p>
            </div>
        </div>
        <button id="play-again-btn" class="main-btn">Play Again</button>
    </div>

    <!-- Socket.IO library -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- Online Manager -->
    <script src="OnlineManager.js"></script>
    
    <!-- Game Code -->
    <script src="GameCode.js"></script>
</body>
</html>